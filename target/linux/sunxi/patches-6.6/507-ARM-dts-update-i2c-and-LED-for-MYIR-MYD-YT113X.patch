From 6c89e5a7139441178b27fdbe9da2e6901735b9bb Mon Sep 17 00:00:00 2001
From: Zoltan HERPAI <wigyori@uid0.hu>
Date: Thu, 31 Aug 2023 13:35:58 +0200
Subject: [PATCH 24/25] ARM: dts: update i2c and LED for MYIR MYD-YT113X

Signed-off-by: Zoltan HERPAI <wigyori@uid0.hu>
---
 arch/arm/boot/dts/allwinner/sun8i-t113s-myd-yt113x.dts | 119 ++++++++++++++++++-
 1 file changed, 114 insertions(+), 5 deletions(-)

--- a/arch/arm/boot/dts/allwinner/sun8i-t113s-myd-yt113x.dts
+++ b/arch/arm/boot/dts/allwinner/sun8i-t113s-myd-yt113x.dts
@@ -14,12 +14,32 @@
 
 	aliases {
 		serial5 = &uart5;
+
+		led-boot = &led_blue;
+		led-failsafe = &led_blue;
+		led-running = &led_blue;
+		led-upgrade = &led_blue;
 	};
 
 	chosen {
 		stdout-path = "serial5:115200n8";
 	};
 
+	leds {
+		compatible = "gpio-leds";
+
+		led_blue: blue {
+			label = "blue";
+			gpios = <&pio 4 2 GPIO_ACTIVE_LOW>; /* PD2 */
+		};
+
+		green {
+			label = "green";
+			gpios = <&pcf9555 6 GPIO_ACTIVE_LOW>;
+			default-state = "on";
+		};
+	};
+
 	/* board wide 5V supply directly from the USB-C socket */
 	reg_vcc5v: regulator-5v {
 		compatible = "regulator-fixed";
@@ -63,7 +83,7 @@
 		regulator-max-microvolt = <3300000>;
 		startup-delay-us = <100000>;
 		enable-active-high;
-		gpio = <&pio 3 6 GPIO_ACTIVE_HIGH>; /* PD6 */
+		gpio = <&pio 4 12 GPIO_ACTIVE_HIGH>; /* PE12 */
 	};
 };
 
@@ -92,6 +112,29 @@
 		pins = "PE6", "PE7";
 		function = "uart5";
 	};
+
+//	rmii_pg_pins: rmii-pg-pins {
+//		pins = "PG0", "PG1", "PG2", "PG3", "PG4",
+//		       "PG5", "PG12", "PG13", "PG14", "PG15";
+//		function = "emac";
+//	};
+
+	rgmii_pg_pins: rgmii-pg-pins {
+		pins = "PG0", "PG1", "PG2", "PG3", "PG4", "PG5",
+		       "PG6", "PG7", "PG8", "PG9", "PG10",
+		       "PG12", "PG14", "PG15";
+		function = "emac";
+	};
+
+	i2c1_pb_pins: i2c1-pb-pins {
+		pins = "PB4", "PB5";
+		function = "i2c1";
+	};
+
+	i2c3_pb_pins: i2c3-pb-pins {
+		pins = "PB6", "PB7";
+		function = "i2c3";
+	};
 };
 
 &uart5 {
@@ -110,6 +153,11 @@
 	status = "okay";
 };
 
+&mmc2_pins {
+	bias-pull-up;
+	drive-strength = <40>;
+};
+
 &mmc2 {
 	pinctrl-0 = <&mmc2_pins>;
 	pinctrl-names = "default";
@@ -119,20 +167,81 @@
 	status = "okay";
 };
 
+
+&ehci0 {
+	status = "okay";
+};
+
+&ohci0 {
+	status = "okay";
+};
+
+&ehci1 {
+	status = "okay";
+};
+
+&ohci1 {
+	status = "okay";
+};
+
+&usbphy {
+	usb1_vbus-supply = <&reg_vcc5v>;
+	status = "okay";
+};
+
+&i2c1 {
+	pinctrl-0 = <&i2c1_pb_pins>;
+	pinctrl-names = "default";
+
+	status = "okay";
+
+	rtc@32 {
+		compatible = "epson,rx8025";
+		reg = <0x32>;
+	};
+};
+
+&i2c3 {
+	pinctrl-0 = <&i2c3_pb_pins>;
+	pinctrl-names = "default";
+
+	status = "okay";
+
+	eeprom@50 {
+		compatible = "atmel,24c32";
+		reg = <0x50>;
+	};
+
+	pcf9555: pcf9555@20 {
+		#gpio-cells = <2>;
+		compatible = "nxp,pca9555";
+		reg = <0x20>;
+	};
+};
+
+
+
+
+
 &mdio {
-	ext_rgmii_phy: ethernet-phy@1 {
+	ext_rgmii_phy: ethernet-phy@0 {
+//		#address-cells = <1>;
+//		#size-cells = <0>;
+//		compatible = "snps,dwmac-mdio";
 		compatible = "ethernet-phy-ieee802.3-c22";
-		reg = <1>;
+
+		reg = <0>;
+		reset-gpios = <&pio 4 11 GPIO_ACTIVE_HIGH>;
 	};
 };
 
 &emac {
 	pinctrl-names = "default";
-	pinctrl-0 = <&rmii_pe_pins>;
+	pinctrl-0 = <&rgmii_pg_pins>;
 
 	phy-supply = <&reg_3v3>;
 	phy-handle = <&ext_rgmii_phy>;
-	phy-mode = "rmii";
+	phy-mode = "rgmii";
 
 	status = "okay";
 };
